function ShopAddgiftsFrontend(){var s=this,o="addgifts__",d=".js-"+o;s.current_ajax=null,s.base_url="/",s.needUpdateCart=function(e){e||(e=0);var t=$(".shop_addgifts--order-cart-item");t.length&&(t.addClass("shop_addgifts--loading"),s.current_ajax&&s.current_ajax.abort(),s.current_ajax=$.getJSON(s.base_url+"shop_addgifts_fullcart/",{sum_in_cart:e},function(e){for(var t in s.current_ajax=null,e.data)$(".shop_addgifts--vid-"+t).replaceWith(e.data[t]);void 0===e.data.after&&$(".shop_addgifts--vid-after").replaceWith('<div class="shop_addgifts--vid-after"></div>')}))},$(document).ajaxSuccess(function(e,t,a){t.responseJSON&&"ok"==t.responseJSON.status&&t.responseJSON.data&&t.responseJSON.data.total&&s.needUpdateCart()}),$(document).on("wa_order_cart_changed",function(e,t){s.needUpdateCart(t.cart.total)}),$(document).on("change",d+"gift--select_gift",function(){var e=$(this),t=e.closest(".addgifts"),a=e.val(),n=o+"gift_p_"+e.data("vid")+"_r_"+e.data("rule-id");s.cookie(n,a),t.closest(".shop_addgifts--order-cart-item").length&&s.needUpdateCart()}),$(document).on("click",d+"change_sku",function(e){e.preventDefault(),$(this).closest(d+"gift").find(d+"skus").addClass(o+"skus--open")}),$(document).on("click",d+"skus_close",function(e){e.preventDefault(),$(this).closest(d+"skus").removeClass(o+"skus--open")}),$(document).on("change",d+"select_sku",function(){var e=$(this),t=e.val(),a=o+"sku_vid_"+e.data("vid")+"_r_"+e.data("rule-id")+"_gi_"+e.data("gift-index");s.cookie(a,t);var n=e.closest(d+"gift").find(d+"sku_name");n.html(e.data("sku-name")),n.data("selected-sku-id",t),e.closest(d+"skus").removeClass(o+"skus--open"),e.closest(".shop_addgifts--order-cart-item").length&&s.needUpdateCart()}),s.cookie=function(e,t,a){if(1<arguments.length&&(null===t||"object"!=typeof t)){if(a=jQuery.extend({path:"/",expires:30},a),null===t&&(a.expires=-1),"number"==typeof a.expires){var n=a.expires,s=a.expires=new Date;s.setDate(s.getDate()+n)}return document.cookie=[encodeURIComponent(e),"=",a.raw?String(t):encodeURIComponent(String(t)),a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}var o,d=(a=t||{}).raw?function(e){return e}:decodeURIComponent;return(o=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?d(o[1]):null},$(document).ready(function(){$.tooltipster&&$(".js-addgifts__tooltip").tooltipster()})}var shop_addgifts__frontend=new ShopAddgiftsFrontend;