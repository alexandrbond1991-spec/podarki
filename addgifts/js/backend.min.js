function ShopAddgiftsBackend(i){var t=this;t.init=function(){$.products.addgiftsAction=function(t){this.load("?plugin="+i+"&action=gifts"+(t?"&id_rule="+t:""),function(){$("#s-sidebar li.selected").removeClass("selected"),$("#s-shop_addgifts__sidebar").addClass("selected")})},$(document).on("product_list_init_view",function(){t.addGiftIcon()}),$(document).on("append_product_list","#product-list",function(){t.addGiftIcon()}),t.addGiftIcon()},t.addGiftIcon=function(){var d=[];$("#product-list .product").each(function(){var t=$(this);t.hasClass("js-addgifts__iconed")||(t.addClass("js-addgifts__iconed"),d.push(t.data("product-id")))}),d.length&&$.get("?plugin="+i+"&action=checkGifts",{ids:d},function(t){if(t.data.with_gifts&&t.data.with_gifts.length)for(var d=0;d<t.data.with_gifts.length;d++)$('#product-list .product[data-product-id="'+t.data.with_gifts[d]+'"]').addClass("b-addgifts__icon")})},$(document).ready(function(){t.init()})}var shop_addgifts__backend=new ShopAddgiftsBackend("addgifts");